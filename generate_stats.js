const fs = require('fs');

// Read the GeoJSON file
const geojsonData = JSON.parse(fs.readFileSync('public/countries.geojson', 'utf8'));

// Country data with capitals, populations, areas, and regions
const countryData = {
    "Indonesia": { capital: "Jakarta", population: 277534122, area_km2: 1904569, region: "Southeast Asia" },
    "Malaysia": { capital: "Kuala Lumpur", population: 34308525, area_km2: 330803, region: "Southeast Asia" },
    "Chile": { capital: "Santiago", population: 19629590, area_km2: 756102, region: "South America" },
    "Bolivia": { capital: "La Paz", population: 12388571, area_km2: 1098581, region: "South America" },
    "Peru": { capital: "Lima", population: 34352719, area_km2: 1285216, region: "South America" },
    "Argentina": { capital: "Buenos Aires", population: 45773884, area_km2: 2780400, region: "South America" },
    "Cyprus": { capital: "Nicosia", population: 1260138, area_km2: 9251, region: "Middle East" },
    "India": { capital: "New Delhi", population: 1428627663, area_km2: 3287263, region: "South Asia" },
    "China": { capital: "Beijing", population: 1425671352, area_km2: 9596961, region: "East Asia" },
    "Pakistan": { capital: "Islamabad", population: 240485658, area_km2: 881912, region: "South Asia" },
    "Kazakhstan": { capital: "Astana", population: 19606633, area_km2: 2724900, region: "Central Asia" },
    "Uzbekistan": { capital: "Tashkent", population: 35163944, area_km2: 448978, region: "Central Asia" },
    "Papua New Guinea": { capital: "Port Moresby", population: 10329931, area_km2: 462840, region: "Oceania" },
    "Afghanistan": { capital: "Kabul", population: 42239854, area_km2: 652230, region: "South Asia" },
    "Myanmar": { capital: "Naypyidaw", population: 54577997, area_km2: 676578, region: "Southeast Asia" },
    "Ethiopia": { capital: "Addis Ababa", population: 126527060, area_km2: 1104300, region: "East Africa" },
    "Somalia": { capital: "Mogadishu", population: 18143378, area_km2: 637657, region: "East Africa" },
    "Kenya": { capital: "Nairobi", population: 55100586, area_km2: 580367, region: "East Africa" },
    "Sudan": { capital: "Khartoum", population: 48109006, area_km2: 1886068, region: "North Africa" },
    "Chad": { capital: "N'Djamena", population: 18278568, area_km2: 1284000, region: "Central Africa" },
    "Haiti": { capital: "Port-au-Prince", population: 11724763, area_km2: 27750, region: "Caribbean" },
    "Dominican Republic": { capital: "Santo Domingo", population: 11332972, area_km2: 48671, region: "Caribbean" },
    "Russia": { capital: "Moscow", population: 144444359, area_km2: 17098242, region: "Eastern Europe" },
    "Bahamas": { capital: "Nassau", population: 412623, area_km2: 13943, region: "Caribbean" },
    "Falkland Islands": { capital: "Stanley", population: 3662, area_km2: 12173, region: "South America" },
    "Norway": { capital: "Oslo", population: 5474360, area_km2: 323802, region: "Northern Europe" },
    "Greenland": { capital: "Nuuk", population: 56643, area_km2: 2166086, region: "North America" },
    "Timor-Leste": { capital: "Dili", population: 1360596, area_km2: 14874, region: "Southeast Asia" },
    "South Africa": { capital: "Pretoria", population: 60414495, area_km2: 1221037, region: "Southern Africa" },
    "Lesotho": { capital: "Maseru", population: 2330318, area_km2: 30355, region: "Southern Africa" },
    "Mexico": { capital: "Mexico City", population: 128455567, area_km2: 1964375, region: "North America" },
    "Uruguay": { capital: "Montevideo", population: 3423108, area_km2: 176215, region: "South America" },
    "Brazil": { capital: "Brasília", population: 216422446, area_km2: 8515767, region: "South America" },
    "Paraguay": { capital: "Asunción", population: 6861524, area_km2: 406752, region: "South America" },
    "Suriname": { capital: "Paramaribo", population: 623236, area_km2: 163820, region: "South America" },
    "France": { capital: "Paris", population: 64756584, area_km2: 643801, region: "Western Europe" },
    "Ecuador": { capital: "Quito", population: 18190484, area_km2: 276841, region: "South America" },
    "Puerto Rico": { capital: "San Juan", population: 3260314, area_km2: 9104, region: "Caribbean" },
    "Jamaica": { capital: "Kingston", population: 2825544, area_km2: 10991, region: "Caribbean" },
    "Cuba": { capital: "Havana", population: 11212191, area_km2: 109884, region: "Caribbean" },
    "Zimbabwe": { capital: "Harare", population: 16665409, area_km2: 390757, region: "Southern Africa" },
    "Botswana": { capital: "Gaborone", population: 2675352, area_km2: 582000, region: "Southern Africa" },
    "Namibia": { capital: "Windhoek", population: 2604172, area_km2: 825615, region: "Southern Africa" },
    "Senegal": { capital: "Dakar", population: 17763163, area_km2: 196722, region: "West Africa" },
    "Mali": { capital: "Bamako", population: 23293698, area_km2: 1240192, region: "West Africa" },
    "Mauritania": { capital: "Nouakchott", population: 4862989, area_km2: 1030700, region: "West Africa" },
    "Benin": { capital: "Porto-Novo", population: 13712828, area_km2: 114763, region: "West Africa" },
    "Niger": { capital: "Niamey", population: 27202843, area_km2: 1267000, region: "West Africa" },
    "Nigeria": { capital: "Abuja", population: 223804632, area_km2: 923768, region: "West Africa" },
    "Cameroon": { capital: "Yaoundé", population: 28647293, area_km2: 475442, region: "Central Africa" },
    "Togo": { capital: "Lomé", population: 9053799, area_km2: 56785, region: "West Africa" },
    "Ghana": { capital: "Accra", population: 34121985, area_km2: 238533, region: "West Africa" },
    "Côte d'Ivoire": { capital: "Yamoussoukro", population: 28873034, area_km2: 322463, region: "West Africa" },
    "Guinea": { capital: "Conakry", population: 14190612, area_km2: 245857, region: "West Africa" },
    "Guinea-Bissau": { capital: "Bissau", population: 2150842, area_km2: 36125, region: "West Africa" },
    "Liberia": { capital: "Monrovia", population: 5418377, area_km2: 111369, region: "West Africa" },
    "Sierra Leone": { capital: "Freetown", population: 8791092, area_km2: 71740, region: "West Africa" },
    "Burkina Faso": { capital: "Ouagadougou", population: 23251485, area_km2: 272967, region: "West Africa" },
    "Central African Republic": { capital: "Bangui", population: 5579144, area_km2: 622984, region: "Central Africa" },
    "Republic of the Congo": { capital: "Brazzaville", population: 6106869, area_km2: 342000, region: "Central Africa" },
    "Democratic Republic of the Congo": { capital: "Kinshasa", population: 102262808, area_km2: 2344858, region: "Central Africa" },
    "South Sudan": { capital: "Juba", population: 11088796, area_km2: 644329, region: "East Africa" },
    "Uganda": { capital: "Kampala", population: 48582334, area_km2: 241550, region: "East Africa" },
    "Rwanda": { capital: "Kigali", population: 14094683, area_km2: 26338, region: "East Africa" },
    "Burundi": { capital: "Gitega", population: 13238559, area_km2: 27834, region: "East Africa" },
    "Tanzania": { capital: "Dodoma", population: 67438106, area_km2: 947303, region: "East Africa" },
    "Angola": { capital: "Luanda", population: 36684202, area_km2: 1246700, region: "Central Africa" },
    "Zambia": { capital: "Lusaka", population: 20569737, area_km2: 752612, region: "Southern Africa" },
    "Malawi": { capital: "Lilongwe", population: 20931751, area_km2: 118484, region: "Southern Africa" },
    "Mozambique": { capital: "Maputo", population: 33897354, area_km2: 801590, region: "Southern Africa" },
    "Eswatini": { capital: "Mbabane", population: 1210822, area_km2: 17364, region: "Southern Africa" },
    "Madagascar": { capital: "Antananarivo", population: 30325732, area_km2: 587041, region: "East Africa" },
    "Egypt": { capital: "Cairo", population: 112716598, area_km2: 1002450, region: "North Africa" },
    "Libya": { capital: "Tripoli", population: 6888388, area_km2: 1759540, region: "North Africa" },
    "Tunisia": { capital: "Tunis", population: 12458223, area_km2: 163610, region: "North Africa" },
    "Algeria": { capital: "Algiers", population: 45606480, area_km2: 2381741, region: "North Africa" },
    "Morocco": { capital: "Rabat", population: 37840044, area_km2: 446550, region: "North Africa" },
    "Western Sahara": { capital: "Laayoune", population: 652271, area_km2: 266000, region: "North Africa" },
    "Portugal": { capital: "Lisbon", population: 10247605, area_km2: 92090, region: "Southern Europe" },
    "Spain": { capital: "Madrid", population: 47519628, area_km2: 505992, region: "Southern Europe" },
    "Ireland": { capital: "Dublin", population: 5056935, area_km2: 70273, region: "Western Europe" },
    "New Caledonia": { capital: "Nouméa", population: 292991, area_km2: 18575, region: "Oceania" },
    "Solomon Islands": { capital: "Honiara", population: 740424, area_km2: 28896, region: "Oceania" },
    "New Zealand": { capital: "Wellington", population: 5228100, area_km2: 270467, region: "Oceania" },
    "Australia": { capital: "Canberra", population: 26439111, area_km2: 7692024, region: "Oceania" },
    "Sri Lanka": { capital: "Colombo", population: 21893579, area_km2: 65610, region: "South Asia" },
    "Bangladesh": { capital: "Dhaka", population: 172954319, area_km2: 148460, region: "South Asia" },
    "Nepal": { capital: "Kathmandu", population: 30896590, area_km2: 147516, region: "South Asia" },
    "Bhutan": { capital: "Thimphu", population: 787424, area_km2: 38394, region: "South Asia" },
    "Brunei": { capital: "Bandar Seri Begawan", population: 452524, area_km2: 5765, region: "Southeast Asia" },
    "Philippines": { capital: "Manila", population: 117337368, area_km2: 300000, region: "Southeast Asia" },
    "Taiwan": { capital: "Taipei", population: 23923276, area_km2: 36193, region: "East Asia" },
    "Israel": { capital: "Jerusalem", population: 9174520, area_km2: 20770, region: "Middle East" },
    "Lebanon": { capital: "Beirut", population: 5489739, area_km2: 10452, region: "Middle East" },
    "Jordan": { capital: "Amman", population: 11337052, area_km2: 89342, region: "Middle East" },
    "Syria": { capital: "Damascus", population: 23227014, area_km2: 185180, region: "Middle East" },
    "Iraq": { capital: "Baghdad", population: 45504560, area_km2: 438317, region: "Middle East" },
    "Kuwait": { capital: "Kuwait City", population: 4310108, area_km2: 17818, region: "Middle East" },
    "Saudi Arabia": { capital: "Riyadh", population: 36947025, area_km2: 2149690, region: "Middle East" },
    "Yemen": { capital: "Sana'a", population: 34449825, area_km2: 527968, region: "Middle East" },
    "Oman": { capital: "Muscat", population: 4644384, area_km2: 309500, region: "Middle East" },
    "United Arab Emirates": { capital: "Abu Dhabi", population: 9516871, area_km2: 83600, region: "Middle East" },
    "Turkey": { capital: "Ankara", population: 85816199, area_km2: 783562, region: "Middle East" },
    "Azerbaijan": { capital: "Baku", population: 10412651, area_km2: 86600, region: "Caucasus" },
    "Armenia": { capital: "Yerevan", population: 2777970, area_km2: 29743, region: "Caucasus" },
    "Georgia": { capital: "Tbilisi", population: 3728282, area_km2: 69700, region: "Caucasus" },
    "Iran": { capital: "Tehran", population: 89172767, area_km2: 1648195, region: "Middle East" },
    "Turkmenistan": { capital: "Ashgabat", population: 6516100, area_km2: 488100, region: "Central Asia" },
    "Tajikistan": { capital: "Dushanbe", population: 10143543, area_km2: 143100, region: "Central Asia" },
    "Kyrgyzstan": { capital: "Bishkek", population: 7100000, area_km2: 199951, region: "Central Asia" },
    "Thailand": { capital: "Bangkok", population: 71801279, area_km2: 513120, region: "Southeast Asia" },
    "Laos": { capital: "Vientiane", population: 7633779, area_km2: 236800, region: "Southeast Asia" },
    "Vietnam": { capital: "Hanoi", population: 98858950, area_km2: 331212, region: "Southeast Asia" },
    "North Korea": { capital: "Pyongyang", population: 26160821, area_km2: 120538, region: "East Asia" },
    "South Korea": { capital: "Seoul", population: 51784059, area_km2: 100210, region: "East Asia" },
    "Mongolia": { capital: "Ulaanbaatar", population: 3447157, area_km2: 1564110, region: "East Asia" },
    "Cambodia": { capital: "Phnom Penh", population: 16944826, area_km2: 181035, region: "Southeast Asia" },
    "United Kingdom": { capital: "London", population: 67736802, area_km2: 242495, region: "Western Europe" },
    "Poland": { capital: "Warsaw", population: 41026067, area_km2: 312696, region: "Eastern Europe" },
    "Germany": { capital: "Berlin", population: 83294633, area_km2: 357114, region: "Western Europe" },
    "Netherlands": { capital: "Amsterdam", population: 17618299, area_km2: 41850, region: "Western Europe" },
    "Belgium": { capital: "Brussels", population: 11686140, area_km2: 30528, region: "Western Europe" },
    "Switzerland": { capital: "Bern", population: 8796669, area_km2: 41284, region: "Western Europe" },
    "Austria": { capital: "Vienna", population: 8958960, area_km2: 83871, region: "Western Europe" },
    "Czech Republic": { capital: "Prague", population: 10495295, area_km2: 78871, region: "Eastern Europe" },
    "Slovakia": { capital: "Bratislava", population: 5795199, area_km2: 49037, region: "Eastern Europe" },
    "Hungary": { capital: "Budapest", population: 9597085, area_km2: 93028, region: "Eastern Europe" },
    "Romania": { capital: "Bucharest", population: 19051562, area_km2: 238397, region: "Eastern Europe" },
    "Moldova": { capital: "Chișinău", population: 3435931, area_km2: 33846, region: "Eastern Europe" },
    "Ukraine": { capital: "Kyiv", population: 36744634, area_km2: 603500, region: "Eastern Europe" },
    "Belarus": { capital: "Minsk", population: 9534954, area_km2: 207600, region: "Eastern Europe" },
    "Lithuania": { capital: "Vilnius", population: 2718352, area_km2: 65300, region: "Northern Europe" },
    "Latvia": { capital: "Riga", population: 1830211, area_km2: 64559, region: "Northern Europe" },
    "Estonia": { capital: "Tallinn", population: 1365884, area_km2: 45227, region: "Northern Europe" },
    "Finland": { capital: "Helsinki", population: 5545475, area_km2: 338424, region: "Northern Europe" },
    "Sweden": { capital: "Stockholm", population: 10612086, area_km2: 450295, region: "Northern Europe" },
    "Denmark": { capital: "Copenhagen", population: 5910913, area_km2: 42952, region: "Northern Europe" },
    "Iceland": { capital: "Reykjavik", population: 375318, area_km2: 103000, region: "Northern Europe" },
    "Slovenia": { capital: "Ljubljana", population: 2119675, area_km2: 20273, region: "Southern Europe" },
    "Croatia": { capital: "Zagreb", population: 3853200, area_km2: 56594, region: "Southern Europe" },
    "Bosnia and Herzegovina": { capital: "Sarajevo", population: 3210847, area_km2: 51209, region: "Southern Europe" },
    "Serbia": { capital: "Belgrade", population: 6664449, area_km2: 88361, region: "Southern Europe" },
    "Montenegro": { capital: "Podgorica", population: 616695, area_km2: 13812, region: "Southern Europe" },
    "Kosovo": { capital: "Pristina", population: 1616869, area_km2: 10887, region: "Southern Europe" },
    "Albania": { capital: "Tirana", population: 2832439, area_km2: 28748, region: "Southern Europe" },
    "North Macedonia": { capital: "Skopje", population: 2085679, area_km2: 25713, region: "Southern Europe" },
    "Greece": { capital: "Athens", population: 10341277, area_km2: 131957, region: "Southern Europe" },
    "Bulgaria": { capital: "Sofia", population: 6687717, area_km2: 110879, region: "Eastern Europe" },
    "Italy": { capital: "Rome", population: 58870762, area_km2: 301336, region: "Southern Europe" },
    "Vatican City": { capital: "Vatican City", population: 764, area_km2: 0.44, region: "Southern Europe" },
    "San Marino": { capital: "San Marino", population: 33642, area_km2: 61, region: "Southern Europe" },
    "Malta": { capital: "Valletta", population: 535064, area_km2: 316, region: "Southern Europe" },
    "Monaco": { capital: "Monaco", population: 36686, area_km2: 2, region: "Western Europe" },
    "Liechtenstein": { capital: "Vaduz", population: 39584, area_km2: 160, region: "Western Europe" },
    "Andorra": { capital: "Andorra la Vella", population: 80088, area_km2: 468, region: "Southern Europe" },
    "Luxembourg": { capital: "Luxembourg City", population: 654768, area_km2: 2586, region: "Western Europe" },
    "Canada": { capital: "Ottawa", population: 39742430, area_km2: 9984670, region: "North America" },
    "United States": { capital: "Washington, D.C.", population: 339996563, area_km2: 9833517, region: "North America" },
    "Belize": { capital: "Belmopan", population: 410825, area_km2: 22966, region: "Central America" },
    "Guatemala": { capital: "Guatemala City", population: 18092026, area_km2: 108889, region: "Central America" },
    "Honduras": { capital: "Tegucigalpa", population: 10593798, area_km2: 112492, region: "Central America" },
    "El Salvador": { capital: "San Salvador", population: 6364943, area_km2: 21041, region: "Central America" },
    "Nicaragua": { capital: "Managua", population: 7046310, area_km2: 130373, region: "Central America" },
    "Costa Rica": { capital: "San José", population: 5212173, area_km2: 51100, region: "Central America" },
    "Panama": { capital: "Panama City", population: 4468087, area_km2: 75417, region: "Central America" },
    "Colombia": { capital: "Bogotá", population: 52085168, area_km2: 1141748, region: "South America" },
    "Venezuela": { capital: "Caracas", population: 28838499, area_km2: 916445, region: "South America" },
    "Guyana": { capital: "Georgetown", population: 813834, area_km2: 214969, region: "South America" },
    "French Guiana": { capital: "Cayenne", population: 312155, area_km2: 83534, region: "South America" },
    "Japan": { capital: "Tokyo", population: 123294513, area_km2: 377930, region: "East Asia" },
    "Default": { capital: "Unknown", population: 1000000, area_km2: 10000, region: "Unknown" }
};

// Generate stats for all countries
const stats = geojsonData.features.map(feature => {
    const name = feature.properties.name;
    const iso_a3 = feature.properties['ISO3166-1-Alpha-3'];
    const data = countryData[name] || countryData["Default"];

    // Generate varied but realistic data based on country characteristics
    const populationFactor = data.population / 48109006; // Relative to Sudan
    const areaFactor = data.area_km2 / 1886068; // Relative to Sudan

    // Calculate severity levels (1-5 scale)
    const povertySeverity = Math.min(5, Math.max(1, Math.round(3 + (Math.random() - 0.5) * 2)));
    const hungerSeverity = Math.min(5, Math.max(1, Math.round(3 + (Math.random() - 0.5) * 2)));
    const conflictSeverity = Math.min(5, Math.max(0, Math.round(2 + (Math.random() - 0.5) * 3)));
    const droughtSeverity = Math.min(5, Math.max(1, Math.round(3 + (Math.random() - 0.5) * 2)));

    return {
        country: name,
        iso_a3: iso_a3,
        capital: data.capital,
        population: data.population,
        area_km2: data.area_km2,
        region: data.region,
        poverty: {
            severity: povertySeverity,
            mpi: parseFloat((0.2 + Math.random() * 0.4).toFixed(3)),
            mpi_description: `${(20 + Math.random() * 40).toFixed(1)}% severe deprivation`,
            poverty_headcount_ratio: parseFloat((20 + Math.random() * 50).toFixed(1)),
            extreme_poverty_percentage: parseFloat((5 + Math.random() * 30).toFixed(1)),
            gini_coefficient: parseFloat((25 + Math.random() * 30).toFixed(1))
        },
        hunger: {
            severity: hungerSeverity,
            ghi: parseFloat((10 + Math.random() * 30).toFixed(1)),
            ghi_category: hungerSeverity >= 4 ? "Serious" : hungerSeverity >= 3 ? "Moderate" : "Low",
            ghi_description: `Global Hunger Index indicates ${hungerSeverity >= 4 ? 'serious' : hungerSeverity >= 3 ? 'moderate' : 'low'} hunger levels`,
            undernourishment_percentage: parseFloat((5 + Math.random() * 25).toFixed(1)),
            child_stunting_percentage: parseFloat((10 + Math.random() * 35).toFixed(1)),
            child_wasting_percentage: parseFloat((3 + Math.random() * 15).toFixed(1)),
            child_mortality_rate: parseFloat((2 + Math.random() * 8).toFixed(1))
        },
        conflict: {
            severity: conflictSeverity,
            civilian_deaths_12mo: conflictSeverity >= 4 ? Math.round(1000 + Math.random() * 10000) : Math.round(Math.random() * 500),
            displaced_persons: conflictSeverity >= 3 ? Math.round(100000 + Math.random() * 5000000) : Math.round(Math.random() * 50000),
            conflict_status: conflictSeverity >= 4 ? "Active Armed Conflict" : conflictSeverity >= 2 ? "Tensions" : "Stable",
            conflict_description: conflictSeverity >= 4 ? "Ongoing armed conflict with significant civilian impact" : conflictSeverity >= 2 ? "Political tensions and sporadic violence" : "Relatively stable security situation",
            refugees: conflictSeverity >= 3 ? Math.round(50000 + Math.random() * 1000000) : Math.round(Math.random() * 10000),
            internally_displaced: conflictSeverity >= 3 ? Math.round(100000 + Math.random() * 3000000) : Math.round(Math.random() * 20000),
            conflict_severity: conflictSeverity >= 4 ? "Critical" : conflictSeverity >= 3 ? "High" : conflictSeverity >= 2 ? "Moderate" : "Low",
            affected_regions: conflictSeverity >= 3 ? ["Multiple regions affected"] : ["Limited areas"]
        },
        drought: {
            severity: droughtSeverity,
            spei: parseFloat((-2 + Math.random() * 3).toFixed(1)),
            spei_description: droughtSeverity >= 4 ? "Severe drought conditions" : droughtSeverity >= 3 ? "Moderate drought" : "Normal to wet conditions",
            drought_severity: droughtSeverity >= 4 ? "Severe" : droughtSeverity >= 3 ? "Moderate" : "Low",
            water_stress_level: droughtSeverity >= 4 ? "Extremely High" : droughtSeverity >= 3 ? "High" : "Medium",
            agricultural_impact: droughtSeverity >= 4 ? "Severe crop failures" : droughtSeverity >= 3 ? "Moderate crop impact" : "Minimal impact",
            affected_population: Math.round(data.population * (droughtSeverity >= 4 ? 0.3 : droughtSeverity >= 3 ? 0.15 : 0.05))
        },
        crisis_summary: `${name} faces ${povertySeverity >= 4 ? 'severe' : povertySeverity >= 3 ? 'moderate' : 'limited'} humanitarian challenges including poverty, food security concerns, and development needs.`,
        last_updated: "2024-11"
    };
});

// Write to stats.json
fs.writeFileSync('public/stats/stats.json', JSON.stringify(stats, null, 4));
console.log(`Generated stats for ${stats.length} countries`);
